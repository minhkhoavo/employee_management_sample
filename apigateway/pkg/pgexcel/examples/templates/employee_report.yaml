version: "1.0"
name: "Employee Report"
description: "Sample employee data export with editable status and notes columns"

# Default styles applied to all sheets unless overridden
defaults:
  header_style:
    font:
      name: "Arial"
      size: 11
      bold: true
      color: "#FFFFFF"
    fill:
      color: "#4472C4"
    alignment: "center"
  data_style:
    font:
      name: "Arial"
      size: 10
    alignment: "left"
  date_format: "2006-01-02"
  number_format: "#,##0.00"

# Variables that can be overridden at runtime
variables:
  DEPARTMENT_ID: "1"
  REPORT_DATE: "2024-01-01"

sheets:
  # Main employee listing with editable columns
  - name: "Employees"
    query: |
      SELECT 
        e.id,
        e.name,
        e.email,
        d.name as department,
        e.salary,
        e.hire_date,
        e.status,
        e.notes
      FROM employees e
      JOIN departments d ON e.department_id = d.id
      WHERE d.id = $1
      ORDER BY e.name
    query_args:
      - "${DEPARTMENT_ID}"
    
    columns:
      - name: "id"
        header: "ID"
        width: 8
        style:
          alignment: "center"
      
      - name: "name"
        header: "Employee Name"
        width: 25
      
      - name: "email"
        header: "Email Address"
        width: 30
      
      - name: "department"
        header: "Department"
        width: 20
      
      - name: "salary"
        header: "Salary"
        width: 15
        format: "$#,##0.00"
        style:
          alignment: "right"
        conditional:
          - condition: "> 100000"
            style:
              fill:
                color: "#FFE699"
              font:
                bold: true
          - condition: "< 30000"
            style:
              fill:
                color: "#FFCCCC"
      
      - name: "hire_date"
        header: "Hire Date"
        width: 12
        format: "2006-01-02"
        style:
          alignment: "center"
      
      - name: "status"
        header: "Status"
        width: 12
        style:
          alignment: "center"
        conditional:
          - condition: "== 'ACTIVE'"
            style:
              font:
                color: "#008000"
                bold: true
          - condition: "== 'INACTIVE'"
            style:
              font:
                color: "#FF0000"
          - condition: "== 'PENDING'"
            style:
              font:
                color: "#FFA500"
      
      - name: "notes"
        header: "Notes"
        width: 40
        style:
          wrap_text: true
    
    layout:
      freeze_rows: 1
      auto_filter: true
      auto_fit_columns: true
      max_column_width: 50
    
    protection:
      password: "emp2024"
      lock_sheet: true
      unlocked_columns:
        - "status"
        - "notes"
      allow_filter: true
      allow_sort: true

  # Summary statistics sheet
  - name: "Summary"
    query: |
      SELECT 
        d.name as department,
        COUNT(*) as employee_count,
        SUM(e.salary) as total_salary,
        AVG(e.salary) as avg_salary,
        MIN(e.hire_date) as first_hire,
        MAX(e.hire_date) as latest_hire
      FROM employees e
      JOIN departments d ON e.department_id = d.id
      GROUP BY d.name
      ORDER BY d.name
    
    columns:
      - name: "department"
        header: "Department"
        width: 20
      
      - name: "employee_count"
        header: "# Employees"
        width: 12
        style:
          alignment: "center"
      
      - name: "total_salary"
        header: "Total Salary"
        width: 15
        format: "$#,##0.00"
        style:
          alignment: "right"
      
      - name: "avg_salary"
        header: "Avg Salary"
        width: 15
        format: "$#,##0.00"
        style:
          alignment: "right"
      
      - name: "first_hire"
        header: "First Hire"
        width: 12
        format: "2006-01-02"
        style:
          alignment: "center"
      
      - name: "latest_hire"
        header: "Latest Hire"
        width: 12
        format: "2006-01-02"
        style:
          alignment: "center"
    
    style:
      header_style:
        font:
          name: "Arial"
          size: 11
          bold: true
          color: "#FFFFFF"
        fill:
          color: "#70AD47"  # Green header for summary
        alignment: "center"
    
    layout:
      freeze_rows: 1
      auto_filter: true
    
    protection:
      lock_sheet: true
      allow_filter: true
